import{bd as p,bk as u,ba as f}from"./index-CDuOHj3I.js";const m=async(e={})=>{try{const r=new URLSearchParams;e.searchQuery&&r.append("searchQuery",e.searchQuery),e.category&&e.category!=="All"&&r.append("category",e.category),e.tags&&r.append("tags",e.tags),e.featured&&r.append("featured","true"),e.createdBy&&r.append("createdBy",e.createdBy),e.limit&&r.append("limit",e.limit.toString()),e.offset&&r.append("offset",e.offset.toString());const a=r.toString(),i=`/api/prompts${a?`?${a}`:""}`,n=await p.get(i);return{prompts:(n.data?.prompts||[]).map(c=>{const o={...c};if(!o.image||o.image===""||o.image==="undefined"||o.image===null){const d=h(o.title),l=o.title||"Prompt";o.image=u({text:l,width:300,height:200,bgColor:d,textColor:"ffffff",fontSize:24})}if(o.inputImage){const d=o.inputImage.startsWith("http")&&!o.inputImage.includes("aiwaverider.com")}return o}),totalCount:n.data?.totalCount||0,currentPage:n.data?.currentPage||1,totalPages:n.data?.totalPages||1,hasMore:n.data?.hasMore||!1,limit:n.data?.limit||20,offset:n.data?.offset||0,searchQuery:n.data?.searchQuery||null,filters:n.data?.filters||{},fromCache:n.data?.fromCache||!1,responseTime:n.data?.responseTime||0}}catch(r){return console.error("Error fetching prompts:",r),{prompts:[],totalCount:0,currentPage:1,totalPages:1,hasMore:!1,limit:20,offset:0,error:r.message}}},h=(e="")=>{if(!e)return"4a69bd";const r=e.toLowerCase();return r.includes("writing")||r.includes("creative")?"8b5cf6":r.includes("marketing")||r.includes("business")?"10b981":r.includes("coding")||r.includes("programming")?"f59e0b":r.includes("education")||r.includes("learning")?"3b82f6":r.includes("content")||r.includes("copywriting")?"ec4899":r.includes("productivity")||r.includes("planning")?"06b6d4":r.includes("social")||r.includes("media")?"ef4444":"6366f1"},y=async(e,r={})=>{try{const a=new URLSearchParams;r.skipCache&&a.append("skipCache","true");const i=a.toString(),n=`/api/prompts/${e}${i?`?${i}`:""}`,s=await p.get(n),t=s.data?.data||s.data;if(t){if(!t.image||t.image===""||t.image==="undefined"||t.image===null||t.image.includes("placeholder")){const c=h(t.title),o=t.title||"Prompt";t.image=u({text:o,width:300,height:200,bgColor:c,textColor:"ffffff",fontSize:24})}if(t.inputImage){const c=t.inputImage.startsWith("http")&&!t.inputImage.includes("aiwaverider.com")}return t}throw new Error("Prompt data not found in response")}catch(a){throw console.error(`Error fetching prompt ${e}:`,a),a}},w=async e=>{try{return(await p.post(`/api/prompts/${e}/view`)).data}catch(r){throw console.error(`Error incrementing view count for prompt ${e}:`,r),r}},P=async()=>{try{return(await p.get("/api/prompts/categories")).data?.data||[]}catch(e){return console.error("Error fetching prompt categories:",e),[]}},A=async(e,r=null,a=null)=>{try{const i=f.currentUser;if(!i)throw new Error("Authentication required. Please log in.");const n=await i.getIdToken(!0);if(!n)throw new Error("Authentication required. Please log in.");const s={...e};if(Array.isArray(s.tags)?s.tags=s.tags.map(t=>String(t)):s.tags=[],Array.isArray(s.keywords)?s.keywords=s.keywords.map(t=>String(t)):s.keywords=[],r&&r instanceof File||a&&a instanceof File){const t=new FormData;Object.keys(s).forEach(o=>{o==="tags"&&Array.isArray(s[o])?s[o].forEach(d=>{t.append("tags",d)}):o==="keywords"&&Array.isArray(s[o])?s[o].forEach(d=>{t.append("keyword",d)}):o==="inputImage"||t.append(o,s[o])}),r&&r instanceof File&&t.append("image",r),a&&a instanceof File&&t.append("inputImage",a);const c=await p.post("/api/prompts",t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${n}`}});return c.data?.data||c.data}else if(r&&typeof r=="string"&&r.startsWith("data:")||a&&typeof a=="string"&&a.startsWith("data:")){const t={...s};r&&typeof r=="string"&&r.startsWith("data:")&&(t.image=r),a&&typeof a=="string"&&a.startsWith("data:")&&(t.inputImage=a);const c=await p.post("/api/prompts",t,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});return c.data?.data||c.data}else{const t=await p.post("/api/prompts",s,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});return t.data?.data||t.data}}catch(i){throw console.error("Error creating prompt:",i),i}},$=async(e,r,a=null,i=null)=>{try{const n=await f.currentUser?.getIdToken(!0);if(!n)throw new Error("Authentication required. Please log in as an admin.");const s={...r};if(Array.isArray(s.tags)&&(s.tags=s.tags.map(t=>String(t))),Array.isArray(s.keywords)&&(s.keywords=s.keywords.map(t=>String(t))),a&&a instanceof File||i&&i instanceof File){const t=new FormData;Object.keys(s).forEach(o=>{o==="tags"&&Array.isArray(s[o])?s[o].forEach(d=>{t.append("tags",d)}):o==="keywords"&&Array.isArray(s[o])?s[o].forEach(d=>{t.append("keyword",d)}):o==="inputImage"||t.append(o,s[o])}),a&&a instanceof File&&t.append("image",a),i&&i instanceof File&&t.append("inputImage",i);const c=await p.put(`/api/prompts/${e}`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${n}`}});return c.data?.data||c.data}else if(a&&typeof a=="string"&&a.startsWith("data:")||i&&typeof i=="string"&&i.startsWith("data:")){const t={...s};a&&typeof a=="string"&&a.startsWith("data:")&&(t.image=a),i&&typeof i=="string"&&i.startsWith("data:")&&(t.inputImage=i);const c=await p.put(`/api/prompts/${e}`,t,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});return c.data?.data||c.data}else{const t=await p.put(`/api/prompts/${e}`,s,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});return t.data?.data||t.data}}catch(n){throw console.error(`Error updating prompt ${e}:`,n),n}},E=async e=>{try{const r=await f.currentUser?.getIdToken(!0);if(!r)throw new Error("Authentication required. Please log in as an admin.");return{success:!0,message:"Prompt deleted successfully",...(await p.delete(`/api/prompts/${e}`,{headers:{Authorization:`Bearer ${r}`}})).data}}catch(r){return console.error(`Error deleting prompt ${e}:`,r),{success:!1,error:r.message||"Failed to delete prompt"}}},C=async e=>{try{const r=await f.currentUser?.getIdToken(!0);if(!r)throw new Error("Authentication required. Please log in.");return(await p.post(`/api/prompts/${e}/like`,{},{headers:{Authorization:`Bearer ${r}`}})).data}catch(r){throw console.error(`Error toggling like for prompt ${e}:`,r),r}},S=async()=>{try{const e=await f.currentUser?.getIdToken(!0);if(!e)throw new Error("Authentication required. Please log in as an admin.");return(await p.post("/api/prompts/cache/refresh",{},{headers:{Authorization:`Bearer ${e}`}})).data}catch(e){throw console.error("Error refreshing prompts cache:",e),e}};export{m as a,A as c,E as d,y as f,P as g,w as i,S as r,C as t,$ as u};
