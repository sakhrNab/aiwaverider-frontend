import{a8 as K,ac as w,t as X,r as p,A as ee,D as ae,j as e,H as te,a9 as se,v as re,aa as ie,N as oe,ab as le}from"./index-CDuOHj3I.js";import{d as ce,v as ne,m as de,e as me,a as he,h as ge,r as pe,t as ue}from"./default-ai-icon-hgQ70KUj.js";import{u as xe}from"./usePromptsStore-CaD82vRv.js";import"./promptsApi-BDedM9HX.js";const be="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='64'%20height='64'%20viewBox='0%200%2064%2064'%3e%3crect%20width='64'%20height='64'%20rx='12'%20fill='%23292949'/%3e%3cpath%20d='M16%2024h32M16%2032h24M16%2040h16'%20stroke='%2300bcd4'%20stroke-width='2'/%3e%3ccircle%20cx='44'%20cy='40'%20r='4'%20fill='%2300bcd4'/%3e%3cpath%20d='M44%2036v8M40%2040h8'%20stroke='%23fff'%20stroke-width='2'/%3e%3c/svg%3e",W="image_cache_metadata",Z="image_cache_metadata_timestamp",fe=1440*60*1e3,we=K((n,m)=>({isLoaded:!1,isLoading:!1,error:null,lastRefreshed:null,cacheStats:{totalImages:0,totalSize:0,memoryCacheSize:0,maxSize:0,maxItems:0},preloadedImages:new Set,startListening:()=>{const s=setInterval(()=>{m().cleanupExpiredCache()},36e5),i=setInterval(()=>{m().updateCacheStats()},300*1e3);return()=>{clearInterval(s),clearInterval(i)}},stopListening:()=>{},getCachedImage:async s=>{try{n({isLoading:!0,error:null});const{getCachedImage:i}=await w(async()=>{const{getCachedImage:o}=await import("./imageCacheService-BIVF85xw.js");return{getCachedImage:o}},[]);return await i(s)}catch(i){return console.error("Error getting cached image:",i),n({error:i.message||"Failed to get cached image"}),null}finally{n({isLoading:!1})}},preloadImages:async s=>{try{n({isLoading:!0,error:null});const{preloadImages:i}=await w(async()=>{const{preloadImages:o}=await import("./imageCacheService-BIVF85xw.js");return{preloadImages:o}},[]);await i(s);const d=s.map(o=>o.image).filter(o=>o&&typeof o=="string"&&!o.startsWith("data:"));n(o=>({preloadedImages:new Set([...o.preloadedImages,...d])}))}catch(i){console.error("Error preloading images:",i),n({error:i.message||"Failed to preload images"})}finally{n({isLoading:!1})}},updateCacheStats:async()=>{try{const{getCacheStats:s}=await w(async()=>{const{getCacheStats:d}=await import("./imageCacheService-BIVF85xw.js");return{getCacheStats:d}},[]),i=s();n({cacheStats:i,lastRefreshed:Date.now()})}catch(s){console.error("Error updating cache stats:",s)}},cleanupExpiredCache:async()=>{try{const{cleanupExpiredCache:s}=await w(async()=>{const{cleanupExpiredCache:i}=await import("./imageCacheService-BIVF85xw.js");return{cleanupExpiredCache:i}},[]);await s(),m().updateCacheStats()}catch(s){console.error("Error cleaning up cache:",s)}},clearImageCache:async()=>{try{const{clearImageCache:s}=await w(async()=>{const{clearImageCache:i}=await import("./imageCacheService-BIVF85xw.js");return{clearImageCache:i}},[]);await s(),n({preloadedImages:new Set,cacheStats:{totalImages:0,totalSize:0,memoryCacheSize:0,maxSize:0,maxItems:0},lastRefreshed:Date.now()})}catch(s){console.error("Error clearing image cache:",s)}},loadFromCache:()=>{try{const s=localStorage.getItem(W),i=localStorage.getItem(Z);if(s&&i){const d=parseInt(i,10);if(Date.now()-d<fe){const b=JSON.parse(s);return n({cacheStats:b.cacheStats||m().cacheStats,preloadedImages:new Set(b.preloadedImages||[]),isLoaded:!0,lastRefreshed:d}),b}}}catch(s){console.error("Error loading from cache:",s)}return null},saveToCache:()=>{try{const{cacheStats:s,preloadedImages:i}=m(),d=Date.now(),o={cacheStats:s,preloadedImages:Array.from(i),timestamp:d};localStorage.setItem(W,JSON.stringify(o)),localStorage.setItem(Z,d.toString())}catch(s){console.error("Error saving to cache:",s)}},forceRefresh:async()=>{await m().clearImageCache(),await m().updateCacheStats()}})),ve="bg-gradient-to-br from-[#4158D0] via-[#C850C0] to-[#FFCC70] stars-pattern",v={Prompt:be,"Text Effects":ue,Relight:pe,Hedra:ge,Ads:he,Eraser:me,"Mind Map":de,Viral:ne,default:ce},Le=()=>{const{darkMode:n}=X(),{user:m}=p.useContext(ee),s=ae(),[i,d]=p.useState(Date.now()),[o,b]=p.useState(new Map),N=p.useRef(new Set),y=m?.role==="admin",{prompts:h,isLoading:C,error:S,isLoaded:V,startListening:L,stopListening:k,forceRefresh:B,lastRefreshed:_,categories:P,currentPage:u,totalPages:x,totalCount:E,pageSize:$,hasMore:Ie,searchQuery:A,filters:R,setSearchQuery:D,setFilters:q,setPage:I,setPageSize:G}=xe(),{preloadImages:M,updateCacheStats:je,startListening:T,stopListening:F}=we(),Y=a=>a?a.startsWith("http://")||a.startsWith("https://")?a:`https://${a}`:"#",J=a=>{const r=a.target,{naturalWidth:t,naturalHeight:l}=r;l>t*1.2?(r.setAttribute("data-aspect","portrait"),r.classList.add("portrait-image")):t>l*1.2?(r.setAttribute("data-aspect","landscape"),r.classList.add("landscape-image")):(r.setAttribute("data-aspect","square"),r.classList.add("square-image")),r.classList.remove("img-loading"),r.classList.add("img-loaded")},z=()=>{B()},f=p.useCallback(a=>{if(!a)return null;const t=/<img[^>]+src="(data:image\/[^"]+)"/g.exec(a);return t&&t[1]?t[1]:null},[]),Q=p.useCallback((a,r)=>{const t=a.target;if(t.onerror=null,t.src&&t.src.startsWith("data:")){const j=f(r.additionalHTML);if(j){t.src=j;return}}const l=f(r.additionalHTML);if(l){t.src=l,t.setAttribute("data-aspect","square"),t.classList.remove("img-loading"),t.classList.add("img-loaded"),t.classList.add("square-image");return}const g=r.category?.split(" ")[0],c=v[g]||v.Prompt;t.src=c,t.setAttribute("data-aspect","square"),t.classList.remove("img-loading"),t.classList.add("img-loaded"),t.classList.add("square-image")},[f]);p.useEffect(()=>{L(),T();const r=setTimeout(()=>{try{const t=localStorage.getItem("prompts_cache");t&&JSON.parse(t).prompts?.some(c=>c.image&&c.image.startsWith("data:image/svg+xml"))&&(localStorage.removeItem("prompts_cache"),localStorage.removeItem("prompts_cache_timestamp"))}catch(t){console.error("Error checking cache:",t)}},1e3);return()=>{clearTimeout(r),k(),F()}},[L,k,T,F]);const H=p.useCallback(a=>{const r=o.get(a.id);if(r)return r;if(a.image&&a.image!==""&&a.image!=="undefined"&&a.image!==null)return a.image;const t=f(a.additionalHTML);if(t)return t;const l=a.category?.split(" ")[0];return v[l]?v[l]:v.Prompt},[o,f]);p.useEffect(()=>{if(h&&h.length>0){const a=new Set(h.map(t=>t.id));if(h.some(t=>!N.current.has(t.id))){N.current=a,M(h);const t=new Map(o);let l=!1;for(const g of h)if(!t.has(g.id)&&g.image){const c=H(g);c&&(t.set(g.id,c),l=!0)}l&&b(t)}}},[h,M,o,H]);const U=a=>{const r=a.target.value;D(r)},O=(a,r)=>{q({[a]:r})};return C&&!V?e.jsxs("div",{className:"flex flex-col justify-center items-center h-screen bg-gradient-to-b from-gray-900 to-blue-900",children:[e.jsx("div",{className:"mb-8",children:e.jsx(te,{color:"#4FD1C5",size:70,speedMultiplier:.8})}),e.jsx("div",{className:"text-white text-xl font-semibold mt-4",children:"Loading Prompts"}),e.jsx("div",{className:"text-blue-300 text-sm mt-2",children:"Discovering the best prompts for you..."})]}):e.jsx("div",{className:`min-h-screen pb-16 ${n?"dark bg-[#2D1846]":"bg-gray-50"} ${ve}`,children:e.jsx("main",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto mt-8",children:[e.jsxs("div",{className:"page-header-3d",children:[e.jsx("div",{className:"absolute inset-0 bg-pattern opacity-30"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h1",{className:"text-4xl sm:text-5xl font-bold text-center mb-4 tracking-tight",children:e.jsx("span",{className:"bg-gradient-to-r from-purple-300 via-pink-300 to-yellow-200 text-transparent bg-clip-text",children:"AI Prompts Directory"})}),e.jsx("p",{className:"text-white/80 text-center text-lg mb-2",children:"Discover the best AI prompts to enhance your creativity"}),e.jsx("div",{className:"w-20 h-1 bg-gradient-to-r from-purple-500 to-pink-500 mx-auto mt-4 rounded-full"})]})]}),S?e.jsxs("div",{className:"text-center py-12 glass-effect rounded-2xl p-6",children:[e.jsx("p",{className:"text-red-400 text-lg mb-4",children:S}),e.jsx("button",{onClick:z,className:"px-4 py-2 bg-white/20 rounded-lg hover:bg-white/30 text-white transition-all",children:"Try Again"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:e.jsxs("div",{className:"flex w-full md:w-auto gap-3",children:[e.jsxs("div",{className:"relative flex-1 md:flex-auto",id:"prompts-search",children:[e.jsx("input",{type:"text",placeholder:"Search prompts...",value:A,onChange:U,className:"search-input w-full md:w-72 px-4 py-3 pr-10 rounded-xl bg-white/10 backdrop-blur-md text-white shadow-lg"}),e.jsx(se,{className:"search-icon absolute right-3 top-1/2 transform -translate-y-1/2 text-white/70"}),A&&e.jsx("button",{type:"button",className:"search-clear-button",onClick:()=>D(""),"aria-label":"Clear search",children:e.jsx(re,{})})]}),y&&e.jsxs("button",{onClick:z,className:"p-3 rounded-xl bg-white/10 backdrop-blur-md hover:bg-white/20 text-white shadow-lg transition-all duration-300 flex items-center justify-center tooltip-container","aria-label":"Refresh data",title:_?`Last updated: ${new Date(_).toLocaleTimeString()}`:"Refresh data",children:[e.jsx(ie,{className:C?"animate-spin":"animate-spin-on-hover"}),e.jsx("span",{className:"tooltip",children:"Refresh"})]})]})}),P.length>0&&e.jsxs("div",{className:"filter-tags-container",children:[e.jsx("button",{onClick:()=>O("category","All"),className:`filter-button ${R.category==="All"?"active":""}`,children:"All"}),P.filter(a=>a.name!=="All").sort((a,r)=>a.name.localeCompare(r.name)).map(a=>e.jsxs("button",{onClick:()=>O("category",a.name),className:`filter-button ${R.category===a.name?"active":""}`,children:[a.name," (",a.count,")"]},a.name))]}),h.length>0?e.jsxs("div",{className:"glass-effect rounded-3xl p-6 shadow-xl transform transition-transform duration-700 hover:scale-[1.01]",children:[e.jsx("div",{className:"content-grid",children:h.map((a,r)=>{const l=o.get(a.id)||a.image||"",g=typeof l=="string"?l:"";return e.jsxs("div",{onClick:()=>s(`/prompts/${a.id}`),className:"group relative bg-gradient-to-br from-purple-900/80 to-purple-800/60 backdrop-blur-sm rounded-xl p-4 cursor-pointer transition-all duration-300 hover:scale-[1.02] hover:shadow-2xl hover:shadow-purple-500/20 border border-purple-700/30",children:[e.jsx("div",{className:"absolute top-3 right-3 z-10",children:e.jsx(oe,{className:"text-yellow-400 text-sm opacity-80 group-hover:opacity-100 transition-opacity"})}),e.jsxs("div",{className:"flex gap-3 items-start pt-4",children:[e.jsx("div",{className:"flex-shrink-0 pt-1",style:{paddingTop:0},children:e.jsx("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gradient-to-br from-purple-600/20 to-purple-500/10 border border-purple-500/30 flex items-center justify-center",children:e.jsx("img",{src:g||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjNmNGY2Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzY2NjY2NiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkxvYWRpbmcuLi48L3RleHQ+PC9zdmc+",alt:a.title,className:"max-w-full max-h-full w-auto h-auto object-contain transition-transform duration-300 group-hover:scale-105",onLoad:J,onError:c=>Q(c,a),loading:"lazy"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-white font-semibold text-base leading-tight mb-1 line-clamp-2 group-hover:text-purple-200 transition-colors",title:a.title,style:{marginTop:0},children:a.title}),e.jsx("p",{className:"text-purple-100/80 text-xs leading-relaxed line-clamp-2 mb-2",children:a.description}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[e.jsx("span",{className:"px-2 py-0.5 bg-purple-700/30 text-purple-200 text-xs rounded-full border border-purple-600/40 backdrop-blur-sm",children:a.category||"Prompt"}),a.tags?.slice(0,2).map((c,j)=>e.jsx("span",{className:"px-2 py-0.5 bg-purple-700/30 text-purple-200 text-xs rounded-full border border-purple-600/40 backdrop-blur-sm hover:bg-purple-600/40 transition-colors",children:c},j)),a.likeCount>0&&e.jsxs("span",{className:"px-2 py-0.5 bg-purple-700/30 text-purple-200 text-xs rounded-full border border-purple-600/40 backdrop-blur-sm",children:["❤️ ",a.likeCount]})]}),a.link&&e.jsx("div",{className:"mt-3",children:e.jsxs("a",{href:Y(a.link),target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-400 hover:text-blue-300 flex items-center transition-colors",onClick:c=>c.stopPropagation(),children:["Visit Source ",e.jsx(le,{className:"ml-1 text-xs"})]})})]})]})]},a.id||`prompt-${r}`)})}),E>0&&e.jsxs("div",{className:"flex justify-center items-center mt-8 pagination-controls",children:[x>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>I(1),disabled:u===1,className:"px-3 py-2 rounded-lg bg-white/10 backdrop-blur-md hover:bg-white/20 text-white shadow-lg transition-all duration-300 mx-1 disabled:opacity-50 disabled:cursor-not-allowed",children:"First"}),e.jsx("button",{onClick:()=>I(u-1),disabled:u===1,className:"px-3 py-2 rounded-lg bg-white/10 backdrop-blur-md hover:bg-white/20 text-white shadow-lg transition-all duration-300 mx-1 disabled:opacity-50 disabled:cursor-not-allowed",children:"« Prev"}),e.jsxs("div",{className:"flex items-center mx-4",children:[e.jsx("span",{className:"text-white/80",children:"Page"}),e.jsx("span",{className:"mx-2 px-3 py-1 bg-white/20 rounded-md text-white font-medium",children:u}),e.jsxs("span",{className:"text-white/80",children:["of ",x]})]}),e.jsx("button",{onClick:()=>I(u+1),disabled:u===x,className:"px-3 py-2 rounded-lg bg-white/10 backdrop-blur-md hover:bg-white/20 text-white shadow-lg transition-all duration-300 mx-1 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next »"}),e.jsx("button",{onClick:()=>I(x),disabled:u===x,className:"px-3 py-2 rounded-lg bg-white/10 backdrop-blur-md hover:bg-white/20 text-white shadow-lg transition-all duration-300 mx-1 disabled:opacity-50 disabled:cursor-not-allowed",children:"Last"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-white/80 mr-2",children:"Show:"}),e.jsxs("select",{value:$,onChange:a=>G(Number(a.target.value)),className:"px-2 py-1 rounded-md bg-white/10 backdrop-blur-md text-white border border-white/20 focus:outline-none focus:ring-2 focus:ring-blue-500 [&>option]:bg-gray-800 [&>option]:text-white",children:[e.jsx("option",{value:"12",children:"12"}),e.jsx("option",{value:"24",children:"24"}),e.jsx("option",{value:"48",children:"48"})]}),x===1&&e.jsxs("span",{className:"ml-3 text-white/60 text-sm",children:["(Showing all ",E," items)"]})]})]}),!navigator.onLine&&e.jsx("div",{className:"mt-4 p-2 bg-amber-500/20 text-amber-200 rounded-lg text-center",children:e.jsx("p",{className:"text-sm font-medium",children:"You are currently offline. Viewing cached data."})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-white/70 mb-4",children:"No prompts found in the database."}),e.jsx("p",{className:"text-white/50 mb-6",children:"Prompts need to be added by an administrator."}),y&&e.jsx("a",{href:"/admin/prompts",className:"px-6 py-3 bg-gradient-to-r from-purple-500/60 to-pink-500/60 rounded-lg text-white font-medium hover:from-purple-500/80 hover:to-pink-500/80 transition-all duration-300",children:"Go to Admin Panel"})]})]})]})})})};export{Le as default};
